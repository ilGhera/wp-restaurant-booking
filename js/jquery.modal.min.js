/*
    A simple jQuery modal (http://github.com/kylefox/jquery-modal)
    Version 0.9.1
*/
!function(a){"object"==typeof module&&"object"==typeof module.exports?a(require("jquery"),window,document):a(jQuery,window,document)}(function(a,k,e,l){var c=[],f=function(){return c.length?c[c.length-1]:null},h=function(){var a,d=!1;for(a=c.length-1;0<=a;a--)c[a].$blocker&&(c[a].$blocker.toggleClass("current",!d).toggleClass("behind",d),d=!0)};a.wprb_modal=function(b,d){var g;if(this.$body=a("body"),this.options=a.extend({},a.wprb_modal.defaults,d),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,
10)),this.$blocker=null,this.options.closeExisting)for(;a.wprb_modal.isActive();)a.wprb_modal.close();if(c.push(this),b.is("a"))if(g=b.attr("href"),this.anchor=b,/^#/.test(g)){if(this.$elm=a(g),1!==this.$elm.length)return null;this.$body.append(this.$elm);this.open()}else{this.$elm=a("<div>");this.$body.append(this.$elm);var e=function(a,b){b.elm.remove()};this.showSpinner();b.trigger(a.wprb_modal.AJAX_SEND);a.get(g).done(function(c){if(a.wprb_modal.isActive()){b.trigger(a.wprb_modal.AJAX_SUCCESS);
var d=f();d.$elm.empty().append(c).on(a.wprb_modal.CLOSE,e);d.hideSpinner();d.open();b.trigger(a.wprb_modal.AJAX_COMPLETE)}}).fail(function(){b.trigger(a.wprb_modal.AJAX_FAIL);f().hideSpinner();c.pop();b.trigger(a.wprb_modal.AJAX_COMPLETE)})}else this.anchor=this.$elm=b,this.$body.append(this.$elm),this.open()};a.wprb_modal.prototype={constructor:a.wprb_modal,open:function(){var b=this;this.block();this.anchor.blur();this.options.doFade?setTimeout(function(){b.show()},this.options.fadeDuration*this.options.fadeDelay):
this.show();a(e).off("keydown.wprb_modal").on("keydown.wprb_modal",function(a){var b=f();27===a.which&&b.options.escapeClose&&b.close()});this.options.clickClose&&this.$blocker.click(function(b){b.target===this&&a.wprb_modal.close()})},close:function(){c.pop();this.unblock();this.hide();a.wprb_modal.isActive()||a(e).off("keydown.wprb_modal")},block:function(){this.$elm.trigger(a.wprb_modal.BEFORE_BLOCK,[this._ctx()]);this.$body.css("overflow","hidden");this.$blocker=a('<div class="'+this.options.blockerClass+
' blocker current"></div>').appendTo(this.$body);h();this.options.doFade&&this.$blocker.css("opacity",0).animate({opacity:1},this.options.fadeDuration);this.$elm.trigger(a.wprb_modal.BLOCK,[this._ctx()])},unblock:function(b){!b&&this.options.doFade?this.$blocker.fadeOut(this.options.fadeDuration,this.unblock.bind(this,!0)):(this.$blocker.children().appendTo(this.$body),this.$blocker.remove(),this.$blocker=null,h(),a.wprb_modal.isActive()||this.$body.css("overflow",""))},show:function(){this.$elm.trigger(a.wprb_modal.BEFORE_OPEN,
[this._ctx()]);this.options.showClose&&(this.closeButton=a('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton));this.$elm.addClass(this.options.wprb_modalClass).appendTo(this.$blocker);this.options.doFade?this.$elm.css({opacity:0,display:"inline-block"}).animate({opacity:1},this.options.fadeDuration):this.$elm.css("display","inline-block");this.$elm.trigger(a.wprb_modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(a.wprb_modal.BEFORE_CLOSE,
[this._ctx()]);this.closeButton&&this.closeButton.remove();var b=this;this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration,function(){b.$elm.trigger(a.wprb_modal.AFTER_CLOSE,[b._ctx()])}):this.$elm.hide(0,function(){b.$elm.trigger(a.wprb_modal.AFTER_CLOSE,[b._ctx()])});this.$elm.trigger(a.wprb_modal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||a('<div class="'+this.options.wprb_modalClass+'-spinner"></div>').append(this.options.spinnerHtml),
this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},_ctx:function(){return{elm:this.$elm,$elm:this.$elm,$blocker:this.$blocker,options:this.options}}};a.wprb_modal.close=function(b){if(a.wprb_modal.isActive())return b&&b.preventDefault(),b=f(),b.close(),b.$elm};a.wprb_modal.isActive=function(){return 0<c.length};a.wprb_modal.getCurrent=f;a.wprb_modal.defaults={closeExisting:!0,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",
modalClass:"modal",blockerClass:"jquery-modal",spinnerHtml:'<div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div>',showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1};a.wprb_modal.BEFORE_BLOCK="modal:before-block";a.wprb_modal.BLOCK="modal:block";a.wprb_modal.BEFORE_OPEN="modal:before-open";a.wprb_modal.OPEN="modal:open";a.wprb_modal.BEFORE_CLOSE="modal:before-close";a.wprb_modal.CLOSE="modal:close";a.wprb_modal.AFTER_CLOSE="modal:after-close";
a.wprb_modal.AJAX_SEND="modal:ajax:send";a.wprb_modal.AJAX_SUCCESS="modal:ajax:success";a.wprb_modal.AJAX_FAIL="modal:ajax:fail";a.wprb_modal.AJAX_COMPLETE="modal:ajax:complete";a.fn.wprb_modal=function(b){return 1===this.length&&new a.wprb_modal(this,b),this};a(e).on("click.wprb_modal",'a[rel~="modal:close"]',a.wprb_modal.close);a(e).on("click.wprb_modal",'a[rel~="modal:open"]',function(b){b.preventDefault();a(this).wprb_modal()})});